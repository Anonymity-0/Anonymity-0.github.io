<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="PortLand: a scalable fault-tolerant layer 2 data center network fabric 💡 Meta Data Title\nPortLand: a scalable fault-tolerant layer 2 data center network fabric\nJournal\nAuthors\nRadhika Niranjan Mysore; Andreas Pamboris; Nathan Farrington; Nelson Huang; Pardis Miri; Sivasankar Radhakrishnan; Vikram Subramanya; Amin Vahdat\n">
<title>Portland</title>

<link rel='canonical' href='https://anonymity-0.github.io/posts/portland/'>

<link rel="stylesheet" href="/scss/style.min.f422e1b5411823880f5c414ca9b2da02907d0b11d5abfbd5d77b8eb1433fbdd3.css"><meta property='og:title' content="Portland">
<meta property='og:description' content="PortLand: a scalable fault-tolerant layer 2 data center network fabric 💡 Meta Data Title\nPortLand: a scalable fault-tolerant layer 2 data center network fabric\nJournal\nAuthors\nRadhika Niranjan Mysore; Andreas Pamboris; Nathan Farrington; Nelson Huang; Pardis Miri; Sivasankar Radhakrishnan; Vikram Subramanya; Amin Vahdat\n">
<meta property='og:url' content='https://anonymity-0.github.io/posts/portland/'>
<meta property='og:site_name' content=''>
<meta property='og:type' content='article'><meta property='article:section' content='Posts' /><meta property='article:tag' content='论文笔记' /><meta property='article:published_time' content='2023-12-20T22:51:25&#43;08:00'/><meta property='article:modified_time' content='2023-12-20T22:51:25&#43;08:00'/>
<meta name="twitter:title" content="Portland">
<meta name="twitter:description" content="PortLand: a scalable fault-tolerant layer 2 data center network fabric 💡 Meta Data Title\nPortLand: a scalable fault-tolerant layer 2 data center network fabric\nJournal\nAuthors\nRadhika Niranjan Mysore; Andreas Pamboris; Nathan Farrington; Nelson Huang; Pardis Miri; Sivasankar Radhakrishnan; Vikram Subramanya; Amin Vahdat\n">

<script src="/js/code-block-enhancer.min.js" defer></script>
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header class="sidebar-header">
        
        <div class="avatar-section">
            
                
                <figure class="site-avatar">
                    <a href="/about" class="avatar-link">
                    
                        
                        
                        
                            
                            <img src="/img/avatar_hu_ef61da91681fc5f7.png" width="300"
                                height="271" class="site-logo" loading="lazy" alt="Avatar">
                        
                    
                    </a>
                    
                        <span class="emoji">🍚</span>
                    
                </figure>
                
            
        </div>
        
        <div class="blog-title">
            <h1 class="site-name"><a href="/">AGA&#39;s Blog</a></h1>
        </div>
        
        <div class="site-meta">
            <h2 class="site-description">Hello World!</h2>
        </div>
    </header><ol class="menu" id="main-menu">
        
        
        
        
            
        
        <li  data-menu-item="首页">
            <a href='/'  class="menu-link">
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>首页</span>
            </a>
        </li>
        
        
        
            
        
        <li  data-menu-item="归档">
            <a href='/archives/'  class="menu-link">
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>归档</span>
            </a>
        </li>
        
        
        
            
        
        <li  data-menu-item="分类">
            <a href='/categories/'  class="menu-link">
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                
                <span>分类</span>
            </a>
        </li>
        
        
        
            
        
        <li  data-menu-item="搜索">
            <a href='/search/'  class="menu-link">
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>搜索</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">
                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#-meta-data">💡 Meta Data</a></li>
    <li><a href="#-研究背景--基础--目的">📜 研究背景 &amp; 基础 &amp; 目的</a></li>
    <li><a href="#-研究内容">📊 研究内容</a>
      <ol>
        <li><a href="#proxy-based-arp">Proxy-based ARP</a></li>
        <li><a href="#distributed-location-discovery">Distributed Location Discovery</a></li>
        <li><a href="#provably-loop-free-forwarding">Provably Loop Free Forwarding</a></li>
        <li><a href="#fault-tolerant-routing">“Fault Tolerant Routing”</a></li>
        <li><a href="#fault-tolerant-routing-for-multicast">Fault Tolerant Routing for Multicast</a></li>
      </ol>
    </li>
    <li><a href="#-研究结论">🚩 研究结论</a></li>
    <li><a href="#-感想--疑问">📌 感想 &amp; 疑问</a>
      <ol>
        <li><a href="#why-existing-l2-and-l3-techniques-can-not-satisfy-r1-5-for-the-cloud-datacenter">Why existing L2 and L3 techniques can not satisfy  R1-5 for the cloud datacenter?</a></li>
        <li><a href="#what-is-pmac-address">What is PMAC address?、</a></li>
        <li><a href="#location-discovery">Location discovery.</a></li>
        <li><a href="#how-portland-satisfies-r1--r5">How PortLand satisfies R1 – R5?</a></li>
      </ol>
    </li>
    <li><a href="#-理论推导">🔬 理论推导</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/%E9%AB%98%E7%BA%A7%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" >
                高级计算机网络
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/posts/portland/">Portland</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Dec 20, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    4 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="portland-a-scalable-fault-tolerant-layer-2-data-center-network-fabric">PortLand: a scalable fault-tolerant layer 2 data center network fabric
</h1><hr>
<h2 id="-meta-data">💡 Meta Data
</h2><div class="table-wrapper"><table><tbody><tr><th style="background-color: rgb(219, 238, 221);"><p style="text-align: left"><span style="background-color: #dbeedd">Title</span></p></th><td style="background-color: rgb(219, 238, 221);"><p><span style="background-color: #dbeedd">PortLand: a scalable fault-tolerant layer 2 data center network fabric</span></p></td></tr><tr><th style="background-color: rgb(243, 250, 244);"><p style="text-align: left"><span style="background-color: #f3faf4">Journal</span></p></th><td style="background-color: rgb(243, 250, 244);"><p></p></td></tr><tr><th style="background-color: rgb(219, 238, 221);"><p style="text-align: left"><span style="background-color: #dbeedd">Authors</span></p></th><td style="background-color: rgb(219, 238, 221);"><p><span style="background-color: #dbeedd">Radhika Niranjan Mysore; Andreas Pamboris; Nathan Farrington; Nelson Huang; Pardis Miri; Sivasankar Radhakrishnan; Vikram Subramanya; Amin Vahdat</span></p></td></tr><tr><th style="background-color: rgb(243, 250, 244);"><p style="text-align: left"><span style="background-color: #f3faf4">Pub. date</span></p></th><td style="background-color: rgb(243, 250, 244);"><p><span style="background-color: #f3faf4">八月 16, 2009</span></p></td></tr><tr><th style="background-color: rgb(219, 238, 221);"><p style="text-align: left"><span style="background-color: #dbeedd">期刊标签</span></p></th><td style="background-color: rgb(219, 238, 221);"><p></p></td></tr><tr><th style="background-color: rgb(243, 250, 244);"><p style="text-align: left"><span style="background-color: #f3faf4">DOI</span></p></th><td style="background-color: rgb(243, 250, 244);"><p><span style="background-color: #f3faf4"><a href="https://doi.org/10.1145/1592568.1592575" rel="noopener noreferrer nofollow">10.1145/1592568.1592575</a></span></p></td></tr><tr><th style="background-color: rgb(219, 238, 221);"><p style="text-align: left"><span style="background-color: #dbeedd">附件</span></p></th><td style="background-color: rgb(219, 238, 221);"><p><span style="background-color: #dbeedd"><a href="zotero://open-pdf/0_LESYP9QN" rel="noopener noreferrer nofollow">Niranjan Mysore 等 - 2009 - PortLand a scalable fault-tolerant layer 2 data c.pdf</a></span></p></td></tr></tbody></table></div>
<h2 id="-研究背景--基础--目的">📜 研究背景 &amp; 基础 &amp; 目的
</h2><hr>
<p>这篇论文的研究背景是针对日益增长的数据中心网络中存在的限制和挑战，例如在现有的层2和层3网络协议在支持大规模数据中心中的灵活性、效率和容错性方面存在的局限性 在笔者提出的论文中，研究的基础是现有网络协议在面临未来单个站点拥有数百万虚拟终端的数据中心时所面临的挑战，特别是关注于如何在这种大规模环境中实现可扩展、易管理、容错和高效的数据中心网络结构</p>
<p>论文的目的是设计和实现一种名为PortLand的协议，该协议旨在解决现有网络在数据中心部署中的局限性，通过提供一种可扩展、容错、并适用于数据中心环境的层2路由和转发协议通过PortLand协议的设计和实施，论文的目的是展示该协议能够支持“即插即用”的大规模数据中心网络，并为数据中心网络提供更灵活、高效和容错的解决方案</p>
<p>ARP是地址解析协议（Address Resolution Protocol），用于将IP地址映射成对应的MAC地址的协议。在局域网中，当一台设备需要发送数据给另一台设备时，它会使用ARP来获取目标设备的MAC地址，以便将数据发送到正确的目标。ARP协议在以太网和其他局域网技术中广泛使用。</p>
<h2 id="-研究内容">📊 研究内容
</h2><hr>
<p><strong>PMAC是如何设计的</strong><br>
PMAC（Pseudo MAC）地址的设计是基于一种层次化的编码方式。在PortLand中，每个主机被分配一个唯一的PMAC地址，该地址编码了主机在拓扑结构上的位置。例如，在同一个pod中的所有终节点的PMAC地址具有相同的前缀。主机保持不变，认为它们仍然使用其实际的MAC地址（AMAC）。当主机发送ARP请求时，它们接收到目标主机的PMAC地址[5a]。所有的数据包转发都是基于PMAC地址进行的，这样可以实现非常小的转发表。发送数据包时，出口交换机会对PMAC地址进行重写，将其转换为目标主机的AMAC地址，以保持主机不变的MAC地址的幻象。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Anonymity-0/Picgo@note_picture/img/image.58jtvgee9ds0.webp"
	
	
	
	loading="lazy"
	
		alt="image"
	
	
></p>
<p>步骤1：当入口交换机首次看到源MAC地址时，会将数据包传送到交换机。</p>
<p>步骤2a：软件在本地PMAC表中创建一个条目，将主机的AMAC和IP地址映射到其PMAC。边缘交换机决定PMAC。</p>
<p>步骤2b：交换机将此映射通信给“Fabric Manager”。</p>
<p>步骤3：“Fabric Manager”使用此状态来响应ARP请求。交换机还会创建适当的流表条目，将 PMAC 目标地址重写为 AMAC，以便对任何发送到主机的流量重写PMAC目的地地址。</p>
<h3 id="proxy-based-arp">Proxy-based ARP
</h3><p>“Ethernet by default broadcasts ARPs to all hosts in the same layer 2 domain. We leverage the fabric manager to reduce broadcast overhead in the common case, as depicted in Figure 3. In step 1, an edge switch intercepts an ARP request for an IP to MAC address mapping and forwards the request to the fabric manager in step 2. The fabric manager consults its PMAC table to see if an entry is available for the target IP address. If so, it returns the PMAC in step 3 to the edge switch. The edge switch creates an ARP reply in step 4 and returns it to the original host.” (Niranjan Mysore 等, 2009, p. 43) 🔤以太网默认情况下会向同一第 2 层域中的所有主机广播 ARP。如图 3 所示，我们利用结构管理器来减少普通情况下的广播开销。在步骤 1 中，边缘交换机拦截 IP 到 MAC 地址映射的 ARP 请求，并在步骤 2 中将请求转发给结构管理器。Fabric 管理器会查询其 PMAC 表，查看是否有目标 IP 地址的条目。如果有，它会在步骤 3 中将 PMAC 返回给边缘交换机。边缘交换机在步骤 4 中创建 ARP 回复，并将其返回给原始主机。🔤</p>
<p><img src="https://cdn.jsdelivr.net/gh/Anonymity-0/Picgo@note_picture/img/image.6pnerd5w0tc0.webp"
	
	
	
	loading="lazy"
	
		alt="image"
	
	
></p>
<p>步骤1-2：边缘交换机拦截针对IP到MAC地址映射的ARP请求，并将请求转发给布线管理器。<strong>ARP请求不被广播</strong>。</p>
<p>步骤3：布线管理器查询其PMAC表，查看目标IP地址是否有条目可用。如果有，则返回PMAC给边缘交换机。</p>
<p>步骤4：边缘交换机创建ARP响应，并将其返回给原始主机。</p>
<p>“Note that end hosts receive PMACs in response to an ARP request and that all packet forwarding proceeds based on the hierarchical PMAC. The egress switch performs PMAC to AMAC rewriting only on the last hop to the destination host.” (Niranjan Mysore 等, 2009, p. 43)</p>
<p>PMAC是针对ARP请求的应答而接收到的，所有数据包转发都是根据层次式PMAC进行的。出口交换机只在最后一跳到达目标主机时才执行PMAC到AMAC的重写。</p>
<h3 id="distributed-location-discovery">Distributed Location Discovery
</h3><p><strong>LDP</strong></p>
<p>“we also present a location discovery protocol (LDP) that requires no administrator configuration. PortLand switches do not begin packet forwarding until their location is established.” (Niranjan Mysore 等, 2009, p. 44) 🔤我们还介绍了一种无需管理员配置的位置发现协议（LDP）。在确定位置之前，PortLand 交换机不会开始转发数据包。🔤</p>
<p><strong>LDM</strong></p>
<p>“PortLand switches periodically send a Location Discovery Message (LDM) out all of their ports both, to set their positions and to monitor liveness in steady state. LDMs contain the following information:” (Niranjan Mysore 等, 2009, p. 44) 🔤PortLand 交换机会定期向其所有端口发送位置发现信息（LDM），以设置其位置并监控稳定状态下的有效性。LDM 包含以下信息：🔤</p>
<ul>
<li>交换机标识符（switch id）：每个交换机的全局唯一标识符，如所有本地端口的最低 MAC 地址。</li>
<li>pod 号码（pod）：同一 pod 中所有交换机共享的号码（见图 1）。不同 pod 中的交换机将有不同的 pod 编号。核心交换机从不设置此值。</li>
<li>位置 (pos)：分配给每个边缘交换机的编号，在每个 pod 中都是唯一的。</li>
<li>树级别（level）：0、1 或 2，取决于交换机是边缘交换机、汇聚交换机还是核心交换机。我们的方法适用于更深的层次结构。</li>
<li>向上/向下（dir）：Up/down（向上/向下）是一个位，表示交换机端口在多根树中的朝向是向下还是向上。</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/Anonymity-0/Picgo@note_picture/img/image.77l4xh96qik0.webp"
	
	
	
	loading="lazy"
	
		alt="image"
	
	
></p>
<blockquote>
<p>行7:如果一个交换机在足够长的时间内没有连接到超过 k/2 个邻居交换机，则它是边缘交换机。行8:incoming_port up 在接收到任何后续的LDM时，边缘交换机推断相应的入站端口是一个朝上的端口。</p></blockquote>
<blockquote>
<p>行10、11:交换机在上行端口上接收到来自边缘交换机的 LDM 时，会断定自己一定是聚合交换机，而且相应的传入端口是下行端口。</p></blockquote>
<blockquote>
<p>行12-13:&ldquo;第12-13行处理核心/聚合交换机向尚未设置部分端口方向的聚合/边缘交换机传输LDMS的情况。&ldquo;行14:核心交换机的验证首先要验证其所有活动端口都已连接到其他 PortLand 交换机</p></blockquote>
<blockquote>
<p>行15-18:然后在第 15-18 行中验证所有邻居都是尚未设置链接方向的汇聚交换机（连接到边缘交换机的汇聚交换机端口已被确定为朝下）。</p></blockquote>
<blockquote>
<p>行20:如果这些条件成立，交换机就可以断定自己是核心交换机，并将其所有端口设置为向下。</p></blockquote>
<blockquote>
<p>如算法 1 第 2-4 行和第 29 行所示，在多个位置号码同时被提议的情况下，聚合交换机会将提议的位置号码保留一段时间，然后再计时。</p></blockquote>
<p>起初，除了交换机标识符和端口号外，其他所有值都是未知的。</p>
<p>我们假设所有交换机端口都处于三种状态之一：断开、连接到终端主机或连接到另一台交换机。</p>
<p>“Edge switches learn their level by determining that some fraction of their ports are host connected.” 🔤边缘交换机通过确定其部分端口已连接主机来了解其等级。🔤</p>
<p>“Level assignment then flows up the tree. Aggregations switches set their level once they learn that some of their ports are connected to edge switches.” 🔤然后，级别分配会沿着树向上流动。汇聚交换机在得知其部分端口连接到边缘交换机后，就会设置自己的级别。🔤</p>
<p>“Finally, core switches learn their levels once they confirm that all ports are connected to aggregation switches.” 🔤最后，核心交换机在确认所有端口都连接到汇聚交换机后，就会学习其级别。🔤</p>
<h3 id="provably-loop-free-forwarding">Provably Loop Free Forwarding
</h3><p>交换机使用 LDP 建立本地位置后，就会利用来自邻居的更新来填充转发表。</p>
<p>核心交换机会了解直接连接的汇聚交换机的 pod 编号。转发数据包时，核心交换机只需检查 PMAC 目标地址中与 pod 编号相对应的位，即可确定适当的输出端口。</p>
<p>汇聚交换机也会了解所有直接连接的边缘交换机的位置编号。汇聚交换机必须通过检查 PMAC 来确定数据包的目的地是同一 pod 中的主机还是不同 pod 中的主机。如果在同一 pod 中，则必须将数据包转发到与 PMAC 中位置条目相对应的输出端口。</p>
<p>如果在不同的 pod 中，在无故障的情况下，数据包可以沿着汇聚交换机的任何链路转发到核心层。为实现负载平衡，交换机可采用多种技术选择合适的输出端口。Fabric 管理器将采用额外的流量表项来覆盖单个流量的默认转发行为。不过，这一决定与本工作无关，因此我们假定采用标准技术，如 ECMP 中的流量散列技术[16]。</p>
<p>我们的转发协议通过观察上行-下行语义[26]可证明是无环的，数据包将总是被转发至聚合交换机或核心交换机，然后向其最终目的地下行传输。我们通过确保一旦数据包开始向下传输，便不可能向拓扑结构的上行传输，以防止瞬时环路和广播风暴。</p>
<h3 id="fault-tolerant-routing">“Fault Tolerant Routing”
</h3><p><img src="https://cdn.jsdelivr.net/gh/Anonymity-0/Picgo@note_picture/img/image.wqfmfdicnr4.webp"
	
	
	
	loading="lazy"
	
		alt="image"
	
	
></p>
<p>步骤1：如果在一段可配置的时间内没有接收到LDM(在此上下文中也称为keepalive)，交换机将在步骤1中假定链路发生故障。</p>
<p>步骤2:检测交换机将故障通知fabric管理器。</p>
<p>步骤3:fabric管理器维护一个包含整个拓扑的每链路连接信息的逻辑故障矩阵，并用新信息更新它。</p>
<p>步骤4:最后，在步骤4中，fabric管理器将故障通知所有受影响的交换机，然后这些交换机根据新版本的拓扑分别重新计算它们的转发表。</p>
<p>“Required state for network connectivity is modest, growing with k3/2 for a fully-configured fat tree built from k-port switches.” (Niranjan Mysore 等, 2009, p. 45) 网络连接所需的状态是适度的，对于由k端口交换机构建的完全配置的胖树来说，它随着k3/2的增长而增长。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Anonymity-0/Picgo@note_picture/img/image.4sshadtqs2a0.webp"
	
	
	
	loading="lazy"
	
		alt="image"
	
	
></p>
<h3 id="fault-tolerant-routing-for-multicast">Fault Tolerant Routing for Multicast
</h3><p>现在我们考虑组播和广播情况下的容错。相对于现有的协议，我们考虑的故障场景是，没有一个单一的生成树植根于一个核心交换机，能够覆盖一个多播组或广播会话的所有接收器。考虑图5中的示例。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Anonymity-0/Picgo@note_picture/img/image.5hddjlvc5o00.webp"
	
	
	
	loading="lazy"
	
		alt="image"
	
	
></p>
<p>在这里，我们有一个多播组映射到最左边的核心交换机。有三个接收器，分布在0号pod和1号pod（图中三个R）。发送端将数据包转发到指定的核心交换机，核心交换机再将数据包分发给接收端。</p>
<p>步骤1：在步骤1中，pod 0中两个突出显示的链接同时失败。</p>
<p>步骤2:两个汇聚交换机检测到故障并通知fabric管理器</p>
<p>步骤3:fabric管理器更新其故障矩阵。</p>
<p>步骤4:fabric管理器计算所有受影响的多播组的转发表项。</p>
<p>步骤5:我们通过计算与每个多播组相关联的接收器集的贪婪集覆盖来处理这种情况。这可能导致多个指定的核心交换机与多播或广播组相关联。fabric管理器在图5的步骤5中将所需的转发状态插入到适当的表中。</p>
<p>从故障中恢复需要通过pod 0中的两个单独的聚合交换机进行转发。但是，不存在同时连接两个汇聚交换机的单核交换机。</p>
<h2 id="-研究结论">🚩 研究结论
</h2><hr>
<h2 id="-感想--疑问">📌 感想 &amp; 疑问
</h2><hr>
<h3 id="why-existing-l2-and-l3-techniques-can-not-satisfy-r1-5-for-the-cloud-datacenter">Why existing L2 and L3 techniques can not satisfy  R1-5 for the cloud datacenter?
</h3><ol>
<li><strong>单一网络结构（R1和R2）：</strong> 云数据中心要求整个数据中心使用一个相同的网络结构，但L3技术需要为每个交换机配置子网信息，而L2技术由于需要支持广播而面临效率和可扩展性的挑战。</li>
<li><strong>透明虚拟机迁移（R3）：</strong> 在L3中，虚拟机迁移到不同子网的主机时需要切换IP地址，这导致透明的迁移变得不可能。而L2的MAC表也面临着在硬件上不切实际的问题。</li>
<li><strong>转发环路问题（R4）：</strong> 无论是L2还是L3，在路由收敛期间都可能发生转发环路问题，这在设计上很困难。</li>
<li><strong>高效路由协议（R5）：</strong> 要求一种能够快速传播拓扑变化的高效路由协议，但现有的L2和L3协议都是基于广播的，效率不高。</li>
</ol>
<h3 id="what-is-pmac-address">What is PMAC address?、
</h3><p>PMAC（Pseudo MAC）地址是PortLand网络设计中使用的一种地址。每个终端主机在PortLand中被分配了一个唯一的PMAC地址，用于编码该主机在网络拓扑中的位置。PMAC地址使得路由转发和虚拟机迁移变得高效。终端主机保持其实际的MAC（AMAC）地址不变，不知道自己被分配了一个PMAC地址。在进行ARP请求时，源主机会收到目标主机的PMAC地址。所有的数据包转发都基于PMAC地址进行，这样可以实现非常小的转发表。出口交换机会对PMAC地址进行转换，以保持目标主机的MAC地址不变。</p>
<h3 id="location-discovery">Location discovery.
</h3><p>位置发现是指在网络中确定设备的位置的过程。根据提供的上下文信息[2]，PortLand使用一种轻量级协议来帮助交换机发现其在拓扑中的位置。交换机通过接收LDM（Link Detection Message）来了解其邻居交换机的信息，通过判断与多少个邻居交换机相连来确定是否为边缘交换机。边缘交换机通常有一半以上的端口连接到终端设备。在确认自己是边缘交换机后，交换机可以通过在所有端口上进行PING操作来进一步确认其位置。终端设备将回复PING请求，而不会发送LDM。</p>
<h3 id="how-portland-satisfies-r1--r5">How PortLand satisfies R1 – R5?
</h3><ol>
<li>R1: VM can migrate, introduce PMAC</li>
<li>R2: no configuration, LDP protocol</li>
<li>R3: use all equal cost paths, ECMP</li>
<li>R4: no loop</li>
<li>R5: failure-tolerant, fabric manager</li>
</ol>
<p>PortLand满足R1-R5的方式如下：</p>
<ol>
<li><strong>R1: 虚拟机迁移和引入PMAC：</strong> PortLand允许虚拟机迁移，并引入了PMAC（Persistent MAC）来保持虚拟机在不同子网上的IP地址不变，实现了透明的虚拟机迁移。</li>
<li><strong>R2: 无需配置和LDP协议：</strong> PortLand不需要在每个交换机上进行繁琐的配置，而是使用了LDP（Label Distribution Protocol）协议，简化了网络管理的复杂性。</li>
<li><strong>R3: 使用所有等价路径和ECMP：</strong> 为了实现更好的负载均衡和性能，PortLand利用ECMP（Equal Cost Multipath）使用所有等价路径，确保数据流可以通过多条路径传输，提高网络利用率。</li>
<li><strong>R4: 无环路：</strong> PortLand设计中考虑了防止转发环路的问题，确保在网络路由收敛时不会出现不必要的循环。</li>
<li><strong>R5: 容错性强，有Fabric Manager：</strong> PortLand具备故障容忍性，通过Fabric Manager进行管理，确保在网络中出现故障时可以及时调整和修复，提高了网络的可靠性和稳定性。</li>
</ol>
<p>是的，这篇文章使用了伪MAC地址（PMAC）技术。</p>
<h2 id="-理论推导">🔬 理论推导
</h2><hr>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/">论文笔记</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css"integrity="sha256-J&#43;iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s="crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js"integrity="sha256-InsNdER1b2xUewP&#43;pKCUJpkhiqwHgqiPXDlIk7GzBu4="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js"integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
	const mainArticleElement = document.querySelector(".main-article");
        renderMathInElement(mainArticleElement, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>

    
</article>

    

    <section class="related-articles-bottom">
    <div class="related-articles-container">
        <h3 class="related-articles-title">相关文章</h3><div class="related-articles-grid"><article class="related-article-card">
                    <a href="https://anonymity-0.github.io/posts/fat-tree/" class="related-article-link">
                        <div class="related-article-content">
                            <h4 class="related-article-title">Fat Tree</h4>
                            <div class="related-article-meta">
                                <span class="related-article-date">
                                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M8 2v4m8-4v4M3 10h18M5 4h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2z"/>
                                    </svg>
                                    2023-12-19
                                </span><span class="related-article-category">
                                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M3 7v10a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2H5a2 2 0 0 0-2-2z"/>
                                        <path d="M8 5v6m8-6v6m-8-2h8"/>
                                    </svg>
                                    高级计算机网络
                                </span></div></div>
                    </a>
                </article></div></div>
</section>
     
    
        
    <script
    src="https://giscus.app/client.js"
    data-repo="Anonymity-0/Anonymity-0.github.io"
    data-repo-id="R_kgDOKsFzXQ"
    data-category="Announcements"
    data-category-id="DIC_kwDOKsFzXc4Ca3tc"
    data-mapping="url"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="bottom"
    data-theme="noborder_light"
    data-lang="en"
    data-loading=""
    crossorigin="anonymous"
    async
></script>
<script>
    function setGiscusTheme(theme) {
        let giscus = document.querySelector("iframe.giscus-frame");
        if (giscus) {
            giscus.contentWindow.postMessage(
                {
                    giscus: {
                        setConfig: {
                            theme: theme,
                        },
                    },
                },
                "https://giscus.app"
            );
        }
    }

    (function () {
        addEventListener("message", (e) => {
            if (event.origin !== "https://giscus.app") return;
            handler();
        });
        window.addEventListener("onColorSchemeChange", handler);

        function handler() {
            if (document.documentElement.dataset.scheme === "light") {
                setGiscusTheme('noborder_light');
            } else {
                setGiscusTheme('0');
            }
        }
    })();
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2025 
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.30.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        
        
        <button class="back-to-top" id="back-to-top" aria-label="回到顶部">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="m18 15-6-6-6 6"/>
            </svg>
        </button>
        
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                const backToTopButton = document.getElementById('back-to-top');
                if (!backToTopButton) return;

                
                const toggleBackToTop = function() {
                    if (window.pageYOffset > 300) {
                        backToTopButton.classList.add('show');
                    } else {
                        backToTopButton.classList.remove('show');
                    }
                };

                
                const scrollToTop = function() {
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                };

                
                window.addEventListener('scroll', toggleBackToTop);
                backToTopButton.addEventListener('click', scrollToTop);

                
                toggleBackToTop();
            });
        </script><script type="text/javascript" src="/ts/menuEffects.js" defer></script><script type="text/javascript" src="/js/force-white-background.min.js"></script>
        
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.87d72694fb97c84cb5cbf9b1a64d476a38e04a5706618a6ffe5b89c7db00488f.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
