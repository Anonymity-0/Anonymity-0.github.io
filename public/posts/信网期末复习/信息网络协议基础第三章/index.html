<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='CIDR •CIDR：Classless Inter-Domain Routing，无类别域间寻路
目前Internet采用的IP地址分配方式，1990年代由IETF提出，取代早期的有类别的地址分配方式 采用可变长度的网络前缀(network prefix)来取代地址分类中网络号长度固定的做法 具有相同前缀的IP地址组成CIDR Block，表示为A.B.C.D/N，其中N为前缀长度 例如202.38.208.0/20 前缀汇聚(Supernetting) 前缀汇聚举例 8个连续的/24的CIDR Block可以用一个/21的CIDR Block来表示，因此对外汇聚成一条/21的路由 200.25.16.0/24~200.25.23.0/24&amp;ndash;〉
(0001 0000~0001 0111)
200.25.16.0/21
前缀最长匹配(Longest-prefix Match) 在CIDR中，如果路由器上的路由表中有多条表项满足要求，则采用前缀最长匹配规则 前缀最长匹配：R0上对于目的地址为200.25.22.32的IP分组分组，匹配的路由表表项包括200.25.16.0/21和200.25.22.0/24，但使用最长匹配规则选择200.25.22.0/24 NAT 根据作用范围的不同，分两种IP地址
全局IP地址：用于Internet上的分组转发，要求在Internet范围内唯一， 私有IP地址：用于指定网络内的分组转发，只要求在指定网内部唯一 基本NAT：只使用IP地址信息 最简单的NAT还是需要多个全局的IP地址，一般在NAT设备上维护一个address pool，address pool中地址的数量应该多于有访问外部网络需求的主机的数量。
网络地址和端口转换NAPT 最常用的一种NAT方式 使用IP地址和TCP/UDP端口号 NAPT操作不仅仅要修改分组的IP头标，还要修改TCP/UDP头标中的端口号 在NAT设备上，虽然内部网络所有的主机共享同一个全局IP地址，但是经过NAT之后不同会话使用的端口号不同 局限性 地址和端口转换将带来比较大的开销 IP地址和端口号可能存在于载荷的任何位置，因此需要软件针对具体的应用做额外的处理 并不是所有的数据都是使用UDP或者TCP来传输 破坏了原有的主机到主机的通信模型 IPv6地址 目前所有IPv6子网的前缀长度都是64比特！
类型 单播地址(Unicast) 分配给节点上的某个特定网络接口,目的地为单播地址的分组被转发到该接口上 组播/多播地址(Multicast) 分配给一组网络接口，这些网络接口一般位于不同的节点，目的地为组播地址被转发到这组接口上 任播地址(Anycast) 分配给一组网络接口,这些网络接口一般位于不同的网络节点，目的地为任播地址的分组被转发到该组接口中距离发送主机最近的节点(依据路由协议度量的最近距离) Anycast 地址从单播地址空间分配，只能被分配给路由器，并且不能用作源地址，用于基于UDP的DNS查询（无状态，无连接），应用范围：站点范围，全局使用还需进一步考虑 单播地址 有些机制，特别是自动配置机制，所需的信息在子网范围内都可以获得，例如获取目标的MAC地址、获取子网前缀等，不需要全局的IPv6地址
链路局部地址（Link-Local）：作用范围为链路，在链路范围内分配 前面10比特固定为1111 1110 10，接下来为54比特的0，具有形式FE80:/64 Interface ID：标识主机上的特定接口 链路局部地址总是自动配置，只用于链路范围内的数据传输 唯一本地地址（Unique Local）：与IPv4私有地址类似，一般限制在组织机构内部使用，但不会被转换成全局单播地址 全局（Global）：作用范围为全局，在全局范围进行分配 ![[Pasted image 20240102122226.png]] 前面3比特固定为001，第1个16比特为2000到3FFF Global Routing Prefix：全局路由前缀，由服务提供商(ISP)分配给用户站点（Site）的前缀 Subnet ID：标识特定的子网，一个站点中可能有多个子网 Interface ID：标识主机上的特定接口，大多数情况下长度为64 单播地址的组成 !'>
<title>信息网络协议基础第三章复习</title>

<link rel='canonical' href='https://anonymity-0.github.io/posts/%E4%BF%A1%E7%BD%91%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/%E4%BF%A1%E6%81%AF%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E5%9F%BA%E7%A1%80%E7%AC%AC%E4%B8%89%E7%AB%A0/'>

<link rel="stylesheet" href="/scss/style.min.abbd69b2908fdfcd5179898beaafd374514a86538d81639ddd2c58c06ae54e40.css"><meta property='og:title' content='信息网络协议基础第三章复习'>
<meta property='og:description' content='CIDR •CIDR：Classless Inter-Domain Routing，无类别域间寻路
目前Internet采用的IP地址分配方式，1990年代由IETF提出，取代早期的有类别的地址分配方式 采用可变长度的网络前缀(network prefix)来取代地址分类中网络号长度固定的做法 具有相同前缀的IP地址组成CIDR Block，表示为A.B.C.D/N，其中N为前缀长度 例如202.38.208.0/20 前缀汇聚(Supernetting) 前缀汇聚举例 8个连续的/24的CIDR Block可以用一个/21的CIDR Block来表示，因此对外汇聚成一条/21的路由 200.25.16.0/24~200.25.23.0/24&amp;ndash;〉
(0001 0000~0001 0111)
200.25.16.0/21
前缀最长匹配(Longest-prefix Match) 在CIDR中，如果路由器上的路由表中有多条表项满足要求，则采用前缀最长匹配规则 前缀最长匹配：R0上对于目的地址为200.25.22.32的IP分组分组，匹配的路由表表项包括200.25.16.0/21和200.25.22.0/24，但使用最长匹配规则选择200.25.22.0/24 NAT 根据作用范围的不同，分两种IP地址
全局IP地址：用于Internet上的分组转发，要求在Internet范围内唯一， 私有IP地址：用于指定网络内的分组转发，只要求在指定网内部唯一 基本NAT：只使用IP地址信息 最简单的NAT还是需要多个全局的IP地址，一般在NAT设备上维护一个address pool，address pool中地址的数量应该多于有访问外部网络需求的主机的数量。
网络地址和端口转换NAPT 最常用的一种NAT方式 使用IP地址和TCP/UDP端口号 NAPT操作不仅仅要修改分组的IP头标，还要修改TCP/UDP头标中的端口号 在NAT设备上，虽然内部网络所有的主机共享同一个全局IP地址，但是经过NAT之后不同会话使用的端口号不同 局限性 地址和端口转换将带来比较大的开销 IP地址和端口号可能存在于载荷的任何位置，因此需要软件针对具体的应用做额外的处理 并不是所有的数据都是使用UDP或者TCP来传输 破坏了原有的主机到主机的通信模型 IPv6地址 目前所有IPv6子网的前缀长度都是64比特！
类型 单播地址(Unicast) 分配给节点上的某个特定网络接口,目的地为单播地址的分组被转发到该接口上 组播/多播地址(Multicast) 分配给一组网络接口，这些网络接口一般位于不同的节点，目的地为组播地址被转发到这组接口上 任播地址(Anycast) 分配给一组网络接口,这些网络接口一般位于不同的网络节点，目的地为任播地址的分组被转发到该组接口中距离发送主机最近的节点(依据路由协议度量的最近距离) Anycast 地址从单播地址空间分配，只能被分配给路由器，并且不能用作源地址，用于基于UDP的DNS查询（无状态，无连接），应用范围：站点范围，全局使用还需进一步考虑 单播地址 有些机制，特别是自动配置机制，所需的信息在子网范围内都可以获得，例如获取目标的MAC地址、获取子网前缀等，不需要全局的IPv6地址
链路局部地址（Link-Local）：作用范围为链路，在链路范围内分配 前面10比特固定为1111 1110 10，接下来为54比特的0，具有形式FE80:/64 Interface ID：标识主机上的特定接口 链路局部地址总是自动配置，只用于链路范围内的数据传输 唯一本地地址（Unique Local）：与IPv4私有地址类似，一般限制在组织机构内部使用，但不会被转换成全局单播地址 全局（Global）：作用范围为全局，在全局范围进行分配 ![[Pasted image 20240102122226.png]] 前面3比特固定为001，第1个16比特为2000到3FFF Global Routing Prefix：全局路由前缀，由服务提供商(ISP)分配给用户站点（Site）的前缀 Subnet ID：标识特定的子网，一个站点中可能有多个子网 Interface ID：标识主机上的特定接口，大多数情况下长度为64 单播地址的组成 !'>
<meta property='og:url' content='https://anonymity-0.github.io/posts/%E4%BF%A1%E7%BD%91%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/%E4%BF%A1%E6%81%AF%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E5%9F%BA%E7%A1%80%E7%AC%AC%E4%B8%89%E7%AB%A0/'>
<meta property='og:site_name' content='AGA&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Posts' /><meta property='article:tag' content='学习笔记' /><meta property='article:published_time' content='2024-01-02T16:12:05&#43;08:00'/><meta property='article:modified_time' content='2024-01-02T16:12:05&#43;08:00'/>
<meta name="twitter:title" content="信息网络协议基础第三章复习">
<meta name="twitter:description" content="CIDR •CIDR：Classless Inter-Domain Routing，无类别域间寻路
目前Internet采用的IP地址分配方式，1990年代由IETF提出，取代早期的有类别的地址分配方式 采用可变长度的网络前缀(network prefix)来取代地址分类中网络号长度固定的做法 具有相同前缀的IP地址组成CIDR Block，表示为A.B.C.D/N，其中N为前缀长度 例如202.38.208.0/20 前缀汇聚(Supernetting) 前缀汇聚举例 8个连续的/24的CIDR Block可以用一个/21的CIDR Block来表示，因此对外汇聚成一条/21的路由 200.25.16.0/24~200.25.23.0/24&amp;ndash;〉
(0001 0000~0001 0111)
200.25.16.0/21
前缀最长匹配(Longest-prefix Match) 在CIDR中，如果路由器上的路由表中有多条表项满足要求，则采用前缀最长匹配规则 前缀最长匹配：R0上对于目的地址为200.25.22.32的IP分组分组，匹配的路由表表项包括200.25.16.0/21和200.25.22.0/24，但使用最长匹配规则选择200.25.22.0/24 NAT 根据作用范围的不同，分两种IP地址
全局IP地址：用于Internet上的分组转发，要求在Internet范围内唯一， 私有IP地址：用于指定网络内的分组转发，只要求在指定网内部唯一 基本NAT：只使用IP地址信息 最简单的NAT还是需要多个全局的IP地址，一般在NAT设备上维护一个address pool，address pool中地址的数量应该多于有访问外部网络需求的主机的数量。
网络地址和端口转换NAPT 最常用的一种NAT方式 使用IP地址和TCP/UDP端口号 NAPT操作不仅仅要修改分组的IP头标，还要修改TCP/UDP头标中的端口号 在NAT设备上，虽然内部网络所有的主机共享同一个全局IP地址，但是经过NAT之后不同会话使用的端口号不同 局限性 地址和端口转换将带来比较大的开销 IP地址和端口号可能存在于载荷的任何位置，因此需要软件针对具体的应用做额外的处理 并不是所有的数据都是使用UDP或者TCP来传输 破坏了原有的主机到主机的通信模型 IPv6地址 目前所有IPv6子网的前缀长度都是64比特！
类型 单播地址(Unicast) 分配给节点上的某个特定网络接口,目的地为单播地址的分组被转发到该接口上 组播/多播地址(Multicast) 分配给一组网络接口，这些网络接口一般位于不同的节点，目的地为组播地址被转发到这组接口上 任播地址(Anycast) 分配给一组网络接口,这些网络接口一般位于不同的网络节点，目的地为任播地址的分组被转发到该组接口中距离发送主机最近的节点(依据路由协议度量的最近距离) Anycast 地址从单播地址空间分配，只能被分配给路由器，并且不能用作源地址，用于基于UDP的DNS查询（无状态，无连接），应用范围：站点范围，全局使用还需进一步考虑 单播地址 有些机制，特别是自动配置机制，所需的信息在子网范围内都可以获得，例如获取目标的MAC地址、获取子网前缀等，不需要全局的IPv6地址
链路局部地址（Link-Local）：作用范围为链路，在链路范围内分配 前面10比特固定为1111 1110 10，接下来为54比特的0，具有形式FE80:/64 Interface ID：标识主机上的特定接口 链路局部地址总是自动配置，只用于链路范围内的数据传输 唯一本地地址（Unique Local）：与IPv4私有地址类似，一般限制在组织机构内部使用，但不会被转换成全局单播地址 全局（Global）：作用范围为全局，在全局范围进行分配 ![[Pasted image 20240102122226.png]] 前面3比特固定为001，第1个16比特为2000到3FFF Global Routing Prefix：全局路由前缀，由服务提供商(ISP)分配给用户站点（Site）的前缀 Subnet ID：标识特定的子网，一个站点中可能有多个子网 Interface ID：标识主机上的特定接口，大多数情况下长度为64 单播地址的组成 !">
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu6c25cd778f8db4d2cb962eb2998a0673_130812_300x0_resize_box_3.png" width="300"
                            height="271" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">🍚</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">AGA&#39;s Blog</a></h1>
            <h2 class="site-description">Hello World!</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/Anonymity-0'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
                <li id="i18n-switch">  
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



                    <select name="language" onchange="window.location.href = this.selectedOptions[0].value">
                        
                            <option value="https://anonymity-0.github.io/" selected>English</option>
                        
                            <option value="https://anonymity-0.github.io/zh-cn/" >中文</option>
                        
                    </select>
                </li>
            
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#heading"></a>
      <ol>
        <li><a href="#cidr">CIDR</a>
          <ol>
            <li><a href="#前缀汇聚supernetting">前缀汇聚(Supernetting)</a></li>
            <li><a href="#前缀最长匹配longest-prefix-match">前缀最长匹配(Longest-prefix Match)</a></li>
          </ol>
        </li>
        <li><a href="#nat">NAT</a>
          <ol>
            <li><a href="#基本nat只使用ip地址信息">基本NAT：只使用IP地址信息</a></li>
            <li><a href="#网络地址和端口转换napt">网络地址和端口转换NAPT</a></li>
            <li><a href="#局限性">局限性</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#ipv6地址">IPv6地址</a>
      <ol>
        <li><a href="#类型">类型</a></li>
        <li><a href="#单播地址">单播地址</a></li>
        <li><a href="#组播地址">组播地址</a>
          <ol>
            <li><a href="#常用组播地址">常用组播地址</a></li>
            <li><a href="#ipv6组播地址到mac地址映射">IPv6组播地址到MAC地址映射</a></li>
          </ol>
        </li>
        <li><a href="#特殊地址">特殊地址</a></li>
        <li><a href="#ipv6网络中的邻居发现机制">IPv6网络中的邻居发现机制</a>
          <ol>
            <li><a href="#地址解析">地址解析</a></li>
            <li><a href="#地址重复检测">地址重复检测</a></li>
            <li><a href="#路由器发现">路由器发现</a></li>
          </ol>
        </li>
        <li><a href="#ipv6地址自动配置过程">IPv6地址自动配置过程</a></li>
        <li><a href="#路由表">路由表</a></li>
        <li><a href="#ipv4ipv6过渡机制">IPv4/IPv6过渡机制</a>
          <ol>
            <li><a href="#手工配置隧道">手工配置隧道</a></li>
            <li><a href="#自动配置隧道">自动配置隧道</a></li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/%E4%BF%A1%E6%81%AF%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E5%9F%BA%E7%A1%80/" >
                信息网络协议基础
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/posts/%E4%BF%A1%E7%BD%91%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/%E4%BF%A1%E6%81%AF%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E5%9F%BA%E7%A1%80%E7%AC%AC%E4%B8%89%E7%AB%A0/">信息网络协议基础第三章复习</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jan 02, 2024</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    2 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="heading"></h2>
<h3 id="cidr">CIDR</h3>
<p>•CIDR：Classless Inter-Domain Routing，无类别域间寻路</p>
<ul>
<li>目前Internet采用的IP地址分配方式，1990年代由IETF提出，取代早期的有类别的地址分配方式</li>
<li>
<ul>
<li>采用可变长度的网络前缀(network prefix)来取代地址分类中网络号长度固定的做法</li>
</ul>
</li>
<li>具有相同前缀的IP地址组成CIDR Block，表示为A.B.C.D/N，其中N为前缀长度</li>
<li>例如202.38.208.0/20</li>
</ul>
<h4 id="前缀汇聚supernetting">前缀汇聚(Supernetting)</h4>
<p>前缀汇聚举例
8个连续的/24的CIDR Block可以用一个/21的CIDR Block来表示，因此对外汇聚成一条/21的路由
200.25.16.0/24~200.25.23.0/24&ndash;〉<br>
(0001 0000~0001 0111)<br>
200.25.16.0/21</p>
<h4 id="前缀最长匹配longest-prefix-match">前缀最长匹配(Longest-prefix Match)</h4>
<ul>
<li>在CIDR中，如果路由器上的路由表中有多条表项满足要求，则采用前缀最长匹配规则</li>
<li>前缀最长匹配：R0上对于目的地址为200.25.22.32的IP分组分组，匹配的路由表表项包括200.25.16.0/21和200.25.22.0/24，但使用最长匹配规则选择200.25.22.0/24</li>
</ul>
<h3 id="nat">NAT</h3>
<p>根据作用范围的不同，分两种IP地址</p>
<ul>
<li>全局IP地址：用于Internet上的分组转发，要求在Internet范围内唯一，</li>
<li>私有IP地址：用于指定网络内的分组转发，只要求在指定网内部唯一</li>
</ul>
<h4 id="基本nat只使用ip地址信息">基本NAT：只使用IP地址信息</h4>
<p>最简单的NAT还是需要多个全局的IP地址，一般在NAT设备上维护一个address pool，address pool中地址的数量应该多于有访问外部网络需求的主机的数量。</p>
<h4 id="网络地址和端口转换napt">网络地址和端口转换NAPT</h4>
<ul>
<li>最常用的一种NAT方式</li>
<li>使用IP地址和TCP/UDP端口号</li>
<li>NAPT操作不仅仅要修改分组的IP头标，还要修改TCP/UDP头标中的端口号
<ul>
<li>在NAT设备上，虽然内部网络所有的主机共享同一个全局IP地址，但是经过NAT之后不同会话使用的端口号不同</li>
</ul>
</li>
</ul>
<h4 id="局限性">局限性</h4>
<ul>
<li>地址和端口转换将带来比较大的开销</li>
<li>IP地址和端口号可能存在于载荷的任何位置，因此需要软件针对具体的应用做额外的处理</li>
<li>并不是所有的数据都是使用UDP或者TCP来传输</li>
<li>破坏了原有的主机到主机的通信模型</li>
</ul>
<h2 id="ipv6地址">IPv6地址</h2>
<p><font color="#ff0000">目前所有IPv6子网的前缀长度都是64比特！</font></p>
<h3 id="类型">类型</h3>
<ul>
<li>单播地址(Unicast)
<ul>
<li>分配给节点上的某个特定网络接口,目的地为单播地址的分组被转发到该接口上</li>
</ul>
</li>
<li>组播/多播地址(Multicast)
<ul>
<li>分配给一组网络接口，这些网络接口一般位于不同的节点，目的地为组播地址被转发到这组接口上</li>
</ul>
</li>
<li>任播地址(Anycast)
<ul>
<li>分配给一组网络接口,这些网络接口一般位于不同的网络节点，目的地为任播地址的分组被转发到该组接口中距离发送主机最近的节点(依据路由协议度量的最近距离)</li>
<li>Anycast 地址从单播地址空间分配，只能被分配给路由器，并且不能用作源地址，用于基于UDP的DNS查询（无状态，无连接），应用范围：站点范围，全局使用还需进一步考虑</li>
</ul>
</li>
</ul>
<h3 id="单播地址">单播地址</h3>
<p>有些机制，特别是自动配置机制，所需的信息在子网范围内都可以获得，例如获取目标的MAC地址、获取子网前缀等，不需要全局的IPv6地址</p>
<ul>
<li>链路局部地址（Link-Local）：作用范围为链路，在链路范围内分配
<ul>
<li>前面10比特固定为1111 1110 10，接下来为54比特的0，具有形式<strong>FE80:/64</strong></li>
<li>Interface ID：标识主机上的特定接口</li>
<li>链路局部地址总是自动配置，只用于链路范围内的数据传输</li>
</ul>
</li>
<li>唯一本地地址（Unique Local）：与IPv4私有地址类似，一般限制在组织机构内部使用，但不会被转换成全局单播地址</li>
<li>全局（Global）：作用范围为全局，在全局范围进行分配
![[Pasted image 20240102122226.png]]
<ul>
<li>前面3比特固定为001，第1个16比特为2000到3FFF</li>
<li>Global Routing Prefix：全局路由前缀，由服务提供商(ISP)分配给用户站点（Site）的前缀</li>
<li>Subnet ID：标识特定的子网，一个站点中可能有多个子网</li>
<li>Interface ID：标识主机上的特定接口，大多数情况下长度为64</li>
</ul>
</li>
</ul>
<p>单播地址的组成
![[Pasted image 20240102122046.png]]</p>
<h3 id="组播地址">组播地址</h3>
<ul>
<li>前面8比特固定为1111 1111，具有形式FF::/8</li>
<li>Flags 4bit: 指示组播地址是永久的还是临时的等信息</li>
<li>Scope 4bits：指示组播的范围
<ul>
<li>0010 Link-local scope</li>
</ul>
</li>
<li>Group ID 112bits：标识组播组，在Scope作用范围内唯一</li>
</ul>
<h4 id="常用组播地址">常用组播地址</h4>
<ul>
<li>全节点地址： FF02::1(link-local) </li>
<li>全路由器地址: FF02::2(link-local) </li>
<li>被请求节点地址（Solicited-node address）
<ul>
<li>例如: 4037::01:800:200E:8C6C ➡️<font color="#ff0000">FF02::1:FF</font>0E:8C6C</li>
</ul>
</li>
</ul>
<h4 id="ipv6组播地址到mac地址映射">IPv6组播地址到MAC地址映射</h4>
<p>网络接口维护一个感兴趣的目的MAC地址列表，包括</p>
<ul>
<li>接口的单播MAC地址</li>
<li>广播MAC地址FF:FF:FF:FF:FF:FF</li>
<li>IPv6组播地址所对应的MAC地址(如果网络接口所在节点加入到组播组，有些组播组是必须加入的，例如全节点组播组，被请求节点地址对应的组播组)
例子：
       IPv6主机具有MAC地址00:AA:00:3F:2A:1C（链路局部地址为FE80:2AA:FF:FE3F:2A1C），其网络接口感兴趣的目的MAC地址表除包含广播MAC地址 FF:FF:FF:FF:FF:FF外，还包括以下组播MAC地址：
       33:33:00:00:00:01，对应着链路局部范围内的全节点组播地址FF02::1
       33:33:FF:3F:2A:1C，对应着被请求节点地址FF02::1:FF:3F:2A1C</li>
</ul>
<h3 id="特殊地址">特殊地址</h3>
<ul>
<li>未指明地址：全0(::)
<ul>
<li>没有有效地址的时候使用</li>
</ul>
</li>
<li>回环地址（::1）
<ul>
<li>指代网络节点本身</li>
</ul>
</li>
</ul>
<h3 id="ipv6网络中的邻居发现机制">IPv6网络中的邻居发现机制</h3>
<p><font color="#ff0000">邻居发现机制基于ICMPv6消息实现，通过ICMPv6消息管理同一链路上的节点到节点通信（网络层机制</font>）
<font color="#ff0000">用于邻居发现的ICMPv6消息的IPv6地址为链路局部地址，Hop limit为255，从而将邻居发现消息限制在链路范围内</font>
邻居发现机制中地址的选择遵循以下原则：</p>
<ol>
<li>源地址：如果节点没有任何有效地址，那么发数据时使用::作为源地址</li>
<li>目的地址：如果节点不知道目的的任何地址包括IPv6地址，则使用FF02::1或者FF02::2
如果节点知道目的的IP地址，但不知道MAC，则使用该IP地址对应的被请求节点地址</li>
</ol>
<h4 id="地址解析">地址解析</h4>
<p>确定邻居节点的链路层地址（MAC地址）</p>
<ul>
<li>通过在节点之间交换邻居请求(NS)和邻居公告(NA)消息来完成</li>
<li>网络层机制：NS和ND均为ICMPv6消息
过程</li>
</ul>
<ol>
<li>判断是否需要进行地址解析过程
<ul>
<li>每个节点维护邻居缓存：邻居IPv6地址&lt;&mdash;&gt;MAC地址</li>
<li>查找邻居缓存</li>
</ul>
</li>
<li>根据需要开始地址解析过程
<ol>
<li>发送节点发送邻居请求（NS）：组播发送，包含要解析的IPv6地址（目标地址）</li>
<li>目标节点接收并处理NS，响应邻居公告（NA））：单播发送，包含目标节点MAC地址</li>
<li>发送节点更新邻居缓存
<strong>例子</strong>
![[Pasted image 20240102135406.png]]
![[Pasted image 20240102135501.png]]</li>
</ol>
</li>
</ol>
<h4 id="地址重复检测">地址重复检测</h4>
<ul>
<li>自动配置地址最重要的是保证地址不重复</li>
<li>为什么IPv6地址只要保证在链路上不重复就可以？</li>
<li>地址重复检测 (DAD)：基于邻居请求（NS）/邻居公告（NA）来实现
<ul>
<li>节点发送NS，其中包含要检测的IPv6地址</li>
<li>如果收到相应的NA，则检测到重复，节点不会使用重复的地址，否则开始使用该IPv6地址
<ul>
<li>检测到地址重复后的具体处理依赖于实现</li>
</ul>
</li>
</ul>
</li>
<li>![[Pasted image 20240102135711.png]]</li>
<li>![[Pasted image 20240102135736.png]]</li>
</ul>
<h4 id="路由器发现">路由器发现</h4>
<ul>
<li>
<p>相关消息</p>
<ul>
<li>路由器公告消息（RA）</li>
<li>路由器请求消息（RS： Router Solicitation）</li>
</ul>
</li>
<li>
<p>具体过程</p>
<ul>
<li>被动式
<ol>
<li>IPv6路由周期性（例如200s）公告RA：组播发送，使用FF02::1</li>
<li>同一链路上的IPv6主机接收RA消息，并且使用其内容来配置或者维护网络参数设置</li>
</ol>
</li>
<li>主动式
<ol>
<li>IPv6主机主动发送路由器请求RS：组播发送，使用<strong>FF02::2</strong></li>
<li>同一链路上的路由器响应RA：单播或者组播方式发送</li>
</ol>
</li>
</ul>
</li>
<li>
<p>![[Pasted image 20240102140212.png]]</p>
</li>
<li>
<p>![[Pasted image 20240102140307.png]]</p>
</li>
</ul>
<h3 id="ipv6地址自动配置过程">IPv6地址自动配置过程</h3>
<p>IPv6节点上地址自动配置过程（基于EUI-64地址）
1.路由器发现过程：主机发送路由器请求（RS）消息，路由器响应路由器公告（RA）消息，获取子网前缀等信息
2.基于FE80::/64 和 EUI-64地址生成的接口标识生成链路局部地址，设置为尝试（Tentative）状态
2.执行地址重复检测(DAD)过程
3.若DAD成功，将其设置为有效（Valid/Preferred）状态
4.<font color="#ff0000">将链路局部地址的被请求节点地址所对应的组播MAC加到网络接口的感兴趣MAC地址表中</font>
5. 根据RA中包含的其它信息进行缺省路由等网络参数的配置
<strong>全局 IPv6 地址=IPv6 前缀 64bits+lpv6 接口标识 64bits</strong>
eg.BC:AE:C5:C2:07:21
一、IPv6借口标识生成</p>
<ol>
<li>MAC地址 U/L 位取反：<font color="#ff0000">BC（1100)</font>:AE:C5:C2:07:21- <font color="#ff0000">BE （1110</font>):AE:C5:C2:07:21</li>
<li>第三个和第四个字节之间插入 <font color="#ff0000">FFFE</font>，变为<font color="#ff0000">BE-AE-C5-FF-FE-C2-07-21</font></li>
<li>写成冒号 16 进制,<font color="#ff0000">BEAE:CSFF:FEC2:721</font>
二、全局 IPv6地址:<font color="#00b0f0">2002:1:0:3</font>:<font color="#ff0000">BEAE:C5FF:FEC2:721</font></li>
</ol>
<h3 id="路由表">路由表</h3>
<ul>
<li>每个路由器和主机都维护路由表（转发表）
<ul>
<li>&lt;目的网络/目的主机、下一跳IP地址、…..&gt;</li>
</ul>
</li>
</ul>
<h3 id="ipv4ipv6过渡机制">IPv4/IPv6过渡机制</h3>
<h4 id="手工配置隧道">手工配置隧道</h4>
<ul>
<li>对每个IPv6分组，都事先手工配置它所对应的隧道的端点，主要是用于隧道封装所需的IPv4地址</li>
</ul>
<h4 id="自动配置隧道">自动配置隧道</h4>
<ul>
<li>分组中所包含的IPv6地址和/或路由的下一跳决定隧道的端点，主要是指用于隧道封装所需的IPv4地址</li>
</ul>
<h5 id="isatap">ISATAP</h5>
<ul>
<li>0:5EFE:w.x.y.z，w.x.y.z为私有单播IPv4地址</li>
<li>200:5EFE:w.x.y.z  w.x.y.z为公共（全局）单播IPv4地址
eg，RI 为ISATAP路由器，为支持 IPv6-in-IPv4 隧道，R1 在网络1中公告IPv6 前缀 <font color="#245bdb">2002:1:0:1::/64</font>，主机 A的IPV4地址：<font color="#245bdb">160:0:0:2</font>，主机 A 的 ISTAP地址？
全局：<font color="#ff0000">2002:1::1</font>:200:5EFE:<font color="#245bdb">160.0.0.2</font>或2002:1:0:1:200:5EFE:160.0.0.2
链路局部：<font color="#ff0000">FE80</font>::200:5EFE:160.0.0.2</li>
</ul>
<p>试着写出ISSTAP路由表，假设前缀为2001:DB8:0:7::/64
host：</p>
<ul>
<li><font color="#ff0000">2001:DB8:0:7::/64. On-Link</font>
同一网段的路由器</li>
<li><font color="#ff0000">FE80</font>::200:5EFE:路由器端口ipv4</li>
</ul>
<p>router</p>
<ul>
<li><font color="#ff0000">2001:DB8:0:7::/64. On-Link</font>
不同的端口</li>
<li>&lt;\下一个router的前缀，连接下一个router的端口ip&gt;</li>
<li>如果没有前缀，就写为::/0</li>
</ul>
<h5 id="6to4">6to4</h5>
<p>根据分配给组织机构的全局（公共）IPv4地址，可以生成并且使用48比特全局IPv6地址前缀（<font color="#ff0000">2002:WWXX:YYZZ::/48</font>）</p>
<p>路由一定有一条：<font color="#ff0000">2002:/16 On-Link</font> Throughthe 6to4 Interface
host指向同一网段的路由器</p>
<ul>
<li>2002:xxxxx
router指 目的，下一跳</li>
<li>&lt;\下一个router的前缀，连接下一个router的端口ip&gt;
–手动隧道配置、自动隧道（ISATAP、6to4）原理和配置</li>
</ul>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css"integrity="sha256-J&#43;iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s="crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js"integrity="sha256-InsNdER1b2xUewP&#43;pKCUJpkhiqwHgqiPXDlIk7GzBu4="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js"integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>
    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/posts/%E4%BF%A1%E7%BD%91%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/%E4%BF%A1%E6%81%AF%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E5%9F%BA%E7%A1%80%E7%AC%AC%E5%85%AD%E7%AB%A0/">
        
        

        <div class="article-details">
            <h2 class="article-title">信息网络协议基础第六章复习</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/posts/%E4%BF%A1%E7%BD%91%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/%E4%BF%A1%E6%81%AF%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E5%9F%BA%E7%A1%80%E7%AC%AC%E4%BA%94%E7%AB%A0/">
        
        

        <div class="article-details">
            <h2 class="article-title">信息网络协议基础第五章复习</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/posts/%E4%BF%A1%E7%BD%91%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/%E7%AC%AC%E5%9B%9B%E7%AB%A0-ip%E7%BD%91%E7%BB%9C%E7%A7%BB%E5%8A%A8%E7%AE%A1%E7%90%86/">
        
        

        <div class="article-details">
            <h2 class="article-title">信息网络协议基础第四章复习</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/posts/%E4%BF%A1%E7%BD%91%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/%E4%BF%A1%E6%81%AF%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E5%9F%BA%E7%A1%80%E7%AC%AC%E4%BA%8C%E7%AB%A0/">
        
        

        <div class="article-details">
            <h2 class="article-title">信息网络协议基础第二章复习</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/posts/%E4%BF%A1%E7%BD%91%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/%E4%BF%A1%E6%81%AF%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E5%9F%BA%E7%A1%80%E7%AC%AC%E4%B8%80%E7%AB%A0/">
        
        

        <div class="article-details">
            <h2 class="article-title">信息网络协议基础第一章复习</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script
    src="https://giscus.app/client.js"
    data-repo="Anonymity-0/Anonymity-0.github.io"
    data-repo-id="R_kgDOKsFzXQ"
    data-category="Announcements"
    data-category-id="DIC_kwDOKsFzXc4Ca3tc"
    data-mapping="url"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="bottom"
    data-theme="dark_high_contrast"
    data-lang="en"
    crossorigin="anonymous"
    async
></script>
<script>
    function setGiscusTheme(theme) {
        let giscus = document.querySelector("iframe.giscus-frame");
        if (giscus) {
            giscus.contentWindow.postMessage(
                {
                    giscus: {
                        setConfig: {
                            theme: theme,
                        },
                    },
                },
                "https://giscus.app"
            );
        }
    }

    (function () {
        addEventListener("message", (e) => {
            if (event.origin !== "https://giscus.app") return;
            handler();
        });
        window.addEventListener("onColorSchemeChange", handler);

        function handler() {
            if (document.documentElement.dataset.scheme === "light") {
                setGiscusTheme('dark_high_contrast');
            } else {
                setGiscusTheme('0');
            }
        }
    })();
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2024 AGA
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.21.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
