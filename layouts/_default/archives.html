{{ define "main" }}
<div class="hx:w-full hx:break-words hx:flex hx:min-h-[calc(100vh-var(--navbar-height))] hx:min-w-0 hx:justify-center hx:pb-8 hx:pr-[calc(env(safe-area-inset-right)-1.5rem)]">
  <main class="hx:w-full hx:min-w-0 hx:max-w-6xl hx:px-6 hx:pt-4 hx:md:px-12">
    <!-- 页面标题 -->
    <div class="hx:mb-8">
      <h1 class="hx:text-3xl hx:font-bold hx:text-gray-900 hx:dark:text-gray-100 hx:mb-2">归档</h1>
    </div>

    <!-- 统计信息 -->
    {{ $pages := where .Site.RegularPages "Type" "in" .Site.Params.mainSections }}
    {{ $notHidden := where .Site.RegularPages "Params.hidden" "!=" true }}
    {{ $filtered := ($pages | intersect $notHidden) }}

    <div class="hx:mb-6 hx:text-sm hx:text-gray-600 hx:dark:text-gray-400">
      共 {{ len $filtered }} 篇文章
    </div>

    <!-- 归档列表 -->
    <div class="archives-container hx:space-y-6">
      {{ range $filtered.GroupByDate "2006" }}
      {{ $id := lower (replace .Key " " "-") }}
      <div class="archives-group" id="{{ $id }}">
        <!-- 年份标题 -->
        <div class="year-header hx:mb-4">
          <h2 class="hx:text-xl hx:font-semibold hx:text-gray-900 hx:dark:text-gray-100 hx:flex hx:items-center hx:gap-2">
            <a href="#{{ $id }}" class="hx:hover:text-blue-600 hx:dark:hover:text-blue-400 hx:transition-colors hx:duration-200">
              {{ .Key }}
            </a>
            <span class="hx:text-sm hx:text-gray-500 hx:dark:text-gray-400 hx:font-normal">
              ({{ len .Pages }} 篇)
            </span>
          </h2>
        </div>

        <!-- 文章列表 -->
        <div class="articles-list hx:space-y-2">
          {{ range .Pages }}
          <article class="article-item hx:bg-white hx:dark:bg-gray-800 hx:border hx:border-gray-200 hx:dark:border-gray-700 hx:rounded-lg hx:p-4 hx:hover:bg-gray-50 hx:dark:hover:bg-gray-750 hx:transition-colors hx:duration-200">
            <div class="hx:flex hx:items-center hx:justify-between hx:gap-4">
              <div class="hx:flex-1 hx:min-w-0">
                <!-- 文章标题 -->
                <h3 class="hx:text-base hx:font-medium hx:mb-1">
                  <a href="{{ .Permalink }}" class="hx:text-gray-900 hx:dark:text-gray-100 hx:hover:text-blue-600 hx:dark:hover:text-blue-400 hx:transition-colors hx:duration-200">
                    {{ .Title }}
                  </a>
                </h3>

                <!-- 文章元信息 -->
                <div class="hx:flex hx:flex-wrap hx:items-center hx:gap-3 hx:text-xs hx:text-gray-500 hx:dark:text-gray-400">
                  <!-- 发布日期 -->
                  <time datetime="{{ .Date.Format "2006-01-02" }}">
                    {{ .Date.Format "01月02日" }}
                  </time>

                  <!-- 分类 -->
                  {{ if .Params.categories }}
                  <span>{{ index .Params.categories 0 }}</span>
                  {{ end }}

                  <!-- 字数统计 -->
                  {{ if .WordCount }}
                  <span>{{ .WordCount }} 字</span>
                  {{ end }}
                </div>
              </div>

              <!-- 标签 -->
              {{ if .Params.tags }}
              <div class="hx:flex hx:flex-wrap hx:gap-1 hx:ml-4">
                {{ range first 2 .Params.tags }}
                <span class="hx:inline-flex hx:items-center hx:px-2 hx:py-0.5 hx:rounded hx:text-xs hx:bg-gray-100 hx:text-gray-700 hx:dark:bg-gray-700 hx:dark:text-gray-300">
                  {{ . }}
                </span>
                {{ end }}
              </div>
              {{ end }}
            </div>
          </article>
          {{ end }}
        </div>
      </div>
      {{ end }}
    </div>
  </main>
</div>
{{ end }}
